import e,{useState as t,useRef as n,useEffect as r}from"react";function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,u,a=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(o){var u=o.api,a=o.dataKey,l=o.displayFields,c=void 0===l?[]:l,f=o.bindFields,d=void 0===f?{}:f,s=i(t([]),2),p=s[0],v=s[1],m=i(t(!1),2),b=m[0],h=m[1],y=i(t(0),2),g=y[0],w=y[1],x=i(t({top:0,left:0,width:0}),2),E=x[0],k=x[1],L=i(t(""),2),S=L[0],A=L[1],C=i(t(""),2),j=C[0],D=C[1],I=n(null);r((function(){fetch(u).then((function(e){return e.json()})).then((function(e){return v(e[a]||[])})).catch(console.error)}),[u,a]),r((function(){var e=[],t=function(e){b&&("ArrowDown"===e.key?(e.preventDefault(),w((function(e){return(e+1)%z.length}))):"ArrowUp"===e.key?(e.preventDefault(),w((function(e){return(e-1+z.length)%z.length}))):"Enter"===e.key?(e.preventDefault(),B(z[g])):"Escape"===e.key&&(e.preventDefault(),h(!1)))};Object.entries(d).forEach((function(n){var r=i(n,2),o=r[0],u=r[1],a=document.getElementById(u);if(a){var l=function(){var e=a.getBoundingClientRect();k({top:e.bottom+window.scrollY,left:e.left+window.scrollX,width:e.width}),D(o),A(a.value||""),h(!0)},c=function(e){A(e.target.value)};a.addEventListener("focus",l),a.addEventListener("keydown",t),a.addEventListener("input",c),e.push((function(){a.removeEventListener("focus",l),a.removeEventListener("keydown",t),a.removeEventListener("input",c)}))}}));var n=function(e){var t;null!==(t=I.current)&&void 0!==t&&t.contains(e.target)||h(!1)};return document.addEventListener("mousedown",n),function(){e.forEach((function(e){return e()})),document.removeEventListener("mousedown",n)}}),[p,d,b]);var O=function(e,t){return t.split(".").reduce((function(e,t){return null==e?void 0:e[t]}),e)},B=function(e){Object.entries(d).forEach((function(t){var n=i(t,2),r=n[0],o=n[1],u=document.getElementById(o),a=O(e,r);u&&void 0!==a&&(u.value=a,u.dispatchEvent(new Event("input",{bubbles:!0})))})),h(!1)},z=p.filter((function(e){var t=O(e,j);return null==t?void 0:t.toString().toLowerCase().includes(S.toLowerCase())}));return b?e.createElement("div",{ref:I,style:{position:"fixed",top:E.top+4,left:E.left,width:E.width,maxHeight:"320px",overflowY:"auto",padding:"8px",backgroundColor:"white",border:"1px solid #e5e7eb",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",borderRadius:"12px",zIndex:9999}},0===z.length&&e.createElement("div",{style:{padding:"8px",fontSize:"14px",color:"#6b7280"}},"No matches found."),z.map((function(t,n){return e.createElement("div",{key:n,onClick:function(){return B(t)},style:{borderRadius:"12px",padding:"12px",marginBottom:"8px",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",border:"1px solid",borderColor:g===n?"#60a5fa":"#e5e7eb",backgroundColor:g===n?"#dbeafe":"#ffffff",cursor:"pointer",transition:"background-color 0.2s ease"}},c.map((function(n,r){return e.createElement("div",{key:r,style:{fontSize:"14px",color:"#374151"}},e.createElement("span",{style:{fontWeight:"800",color:"#1f2937",textDecoration:"underline"}},n.split(".").pop(),":")," ",O(t,n))})))}))):null}export{u as BRQSmartPopup};
//# sourceMappingURL=index.esm.js.map
